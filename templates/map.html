{% comment %} {% load static %} {% endcomment %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Add Leaflet CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css" />
    
    <!-- Add Leaflet JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script>
    <!--mapbox-->
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio User Map</title>
    <title>User Locations Map</title>
    {% load leaflet_tags %}
    {% leaflet_css %}
    {% leaflet_js %}
    <style>       
        #map {
            height: 100vh;
         
        }
    </style>
</head>
<body>
    <div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    // Wait for the DOM to load
    document.addEventListener('DOMContentLoaded', function() {
        // Replace 'YOUR_MAPBOX_ACCESS_TOKEN' with your actual Mapbox access token
        var accessToken = 'pk.eyJ1IjoiY3BpbWVudGVsMTAiLCJhIjoiY2xmNzN5M2NvMTFiazNxcWhsbHpjeG50ZCJ9.3HRr4PdxwmwdHRQgsU4oyg';

        // Create the Leaflet map and specify the map's container
        var map = L.map('map').setView([0, 0], 2);

        // Add the tile layer
        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=' + accessToken, {
            attribution: 'Map data &copy; <a href="https://www.mapbox.com/">Mapbox</a>',
            maxZoom: 18,
            id: 'mapbox/streets-v11', // Replace with your desired Mapbox style
            tileSize: 512,
            zoomOffset: -1,
        }).addTo(map);

        var user_locations = {{ user_locations|safe }};

        user_locations.forEach(function(location) {
            var marker = L.marker([location.lat, location.lng]).addTo(map);
            marker.bindPopup('<h3>' + location.name + '</h3>');
        });
    });
</script>
    
</body>
</html>